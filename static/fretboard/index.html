<!DOCTYPE html>
<html>
    <head>
        <style>@import url(https://fonts.googleapis.com/css2?family=Literata:ital,opsz,wght@0,7..72,200..900;1,7..72,200..900&display=swap);:root {
    --font: 'literata';

    --darkest: rgb(20, 20, 20);
    
    --text-light: white;
    --text-darker: #939394;

    --button-bg: #ffffff1e; 
    --button-shadow: rgba(0, 0, 0, 0.075) 0px 0px 0px 1px;
    --button-hover: #575757; 
    --button-text-colour: #7a7a7a;

    background-color: var(--darkest);
    font-family: var(--font);
}

body {
    overflow: hidden; 
    margin: 0; 
    color: var(--text-light)
}</style>
        <style>
body {
    min-width: 700px;
    display: flex;
    justify-content: center;
}

#nav { margin-top: 30px; }

input        { color: var(--text-light); }
a            { color: var(--text-darker); text-decoration: underline; }
a:hover      { color: var(--text-light); cursor: pointer; }
fieldset     { border: none; font-size: 15px; }
button:hover { background-color: var(--button-hover) }

#settings {
    position: absolute; 
    height: 80px;
    top: calc( 30% - 80px );
    width: 100%; 
    display: flex;
    flex-direction: row;
    justify-content: center;
}

#settings > div {
    display: flex;
    flex-direction: column;
    padding: 20px;
    width: 180px;
    min-width: 140px;
    padding: auto;
    align-items: center;
    justify-content: center;
}

input[ type="number" ], input[ type="text" ] {
    font-family: var(--font);
    background-color: transparent;
    border: none;
    font-size: 18px;
    text-align: center;
    color: var(--text-darker);
}

#fretboard {
    position: absolute;
    height: 50%;
    max-width: 1920px;
    top: 30%; 
    max-height: 400px;
}

#buttons {
    position: absolute;
    height: 90px;
    top: calc( 30% - 140px );
    width: 100%; 
    display: flex;
    flex-direction: row;
    justify-content: center;
}

button {
    font-family: var(--font);
    width: 170px;
    height: 40px;
    margin: 10px;
    border: none; 
    border-radius: 3px;
    background-color: var(--button-bg);
    box-shadow: var(--button-shadow);
    color: var(--text-light);
}

</style>
        <title> Fretboard | Ryan Kavanagh </title>
    </head>
    <body>
        <div id="nav">
            <a onclick="history.back()"> < back </a>
        </div>
        <div id="buttons">
            <button id="clear"> Clear Fretboard </button>
            <button id="download"> Download </button>
        </div>
        <div id="settings">
            <div id="tuning">
                <label for="tuning-input"> Tuning </label>
                <input type="text" id="tuning-input" value="E,A,D,G,B,E" />
            </div>
            <div id="frets">
                <label for="frets-input"> Fret range </label>
                <input type="text" id="frets-input" value="0-22" />
            </div>
            <div id="accidentals">
                <form name="accidentalsForm">
                    <fieldset>
                        <input name="accidentals" type="radio" value="sharps" checked="true">
                        <label for="sharps"> Sharps </label>
                        <br>
                        <input name="accidentals" type="radio" value="flats">
                        <label for="flats"> Flats </label>
                    </fieldset>
                </form>
            </div>
            <div id="scale">
                <label for="scale-input"> Load scale </label>
                <input type="text" id="scale-input" placeholder="Enter scale name" />
            </div>
        </div>
        <canvas id="fretboard"></canvas>
    </body>
    <script>(()=>{"use strict";var t,e,n={},r={};function l(t){var e=r[t];if(void 0!==e)return e.exports;var i=r[t]={exports:{}};return n[t](i,i.exports,l),i.exports}e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,l.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var i=Object.create(null);l.r(i);var o={};t=t||[null,e({}),e([]),e(e)];for(var s=2&r&&n;"object"==typeof s&&!~t.indexOf(s);s=e(s))Object.getOwnPropertyNames(s).forEach((t=>o[t]=()=>n[t]));return o.default=()=>n,l.d(i,o),i},l.d=(t,e)=>{for(var n in e)l.o(e,n)&&!l.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},l.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),l.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.d({},{gatherParameters:()=>w,notes:()=>b});const i=JSON.parse('{"major":[2,2,1,2,2,2,1],"minor":[2,1,2,2,1,2,2],"ionian":[2,2,1,2,2,2,1],"dorian":[2,1,2,2,2,1,2],"phrygian":[1,2,2,2,1,2,2],"lydian":[2,2,2,1,2,2,1],"mixolydian":[2,2,1,2,2,1,2],"aeolian":[2,1,2,2,1,2,2],"locrian":[1,2,2,1,2,2,2],"harmonic minor":[2,1,2,2,1,3,1],"melodic minor":[2,1,2,2,2,2,1],"minor pentatonic":[3,2,2,3,2],"major pentatonic":[2,2,3,2,3],"blues":[3,2,1,1,3,2]}');var o=l.t(i,2);function s(t){let e,n,r=document.getElementById("scale-input").value;if(r){try{let t=r.split(" ");t=t.map((t=>t.toLowerCase().replace(/\s/g,""))),t=t.filter((t=>""!=t.trim())),e=t[0],t.splice(0,1),n=t.join(" ")}catch(t){return void console.log(t)}return b.sharps.includes(e)||b.flats.includes(e)?b[t.accidentals].includes(e)?void(Object.keys(o).includes(n)?function(t,e,n){let r=b[t.accidentals].indexOf(e),l=[];for(let e of n)l.push(b[t.accidentals][r%12]),r+=e;for(let e of t.strings)e.selected=[];for(let n in t.strings){r=b[t.accidentals].indexOf(t.strings[n].pitch);for(let i=t.startFret;i<=t.endFret;i++){let o=b[t.accidentals][(i+r)%12];l.includes(o)&&t.strings[n].selected.push({fret:i,colour:o===e?c.rightClick:c.leftClick})}}}(t,e,o[n]):alert("Scale not found")):(t.accidentals="flats"===t.accidentals?"sharps":"flats",document.accidentalsForm.accidentals.value=t.accidentals,s(t)):alert("Invalid root note")}}const c={noteBorder:"white",noteText:"white",grid:"#717171",rightClick:"#ff6347",leftClick:"#717171"};let a,d,f,u,g,h,p={},m={top:30,bottom:50,left:35,right:20};function y(t,e,n){let r=t.offsetX-m.left,l=t.offsetY-m.top+a/2;r<0&&(r=0),l<0&&(l=0),r=Math.floor(r/d)+e.startFret,l=Math.floor(l/a),l>h&&(l=h);let i=!1;for(let t in e.strings[l].selected){let o=e.strings[l].selected[t];o.fret===r&&(o.colour!==c.rightClick||n?o.colour===c.leftClick&&n?o.colour=c.rightClick:e.strings[l].selected.splice(t,1):o.colour=c.leftClick,i=!0)}i||e.strings[l].selected.push({fret:r,colour:n?c.rightClick:c.leftClick}),w()}let v=35;const b={sharps:["a","a#","b","c","c#","d","d#","e","f","f#","g","g#"],flats:["a","bb","b","c","db","d","eb","e","f","gb","g","ab"]};let F={startFret:void 0,endFret:void 0,accidentals:void 0,strings:[]};function w(t){let e={frets:document.getElementById("frets-input"),tuning:document.getElementById("tuning-input"),scale:document.getElementById("scale-input"),accidentals:document.querySelector('input[name="accidentals"]:checked')};F.scale=e.scale.value,F.tuning=e.tuning.value.replace(/\s/g,"").trim().toLowerCase().split(",").reverse();let n=e.frets.value.replace(/\s/g,"").split("-");return F.startFret=parseInt(n[0]),F.endFret=parseInt(n[1]),(isNaN(F.startFret)||isNaN(F.endFret))&&(F.startFret=0,F.endFret=24),F.startFret=F.startFret>=F.endFret?0:F.startFret,F.endFret=F.endFret>v?v:F.endFret,e.frets.value=F.startFret+"-"+F.endFret,F.accidentals=e.accidentals.value,F.tuning=F.tuning.filter((t=>""!==t&&b[F.accidentals].includes(t))),F.tuning.length<2?alert("At least 2 strings required"):F.tuning.join("").includes("b")&&F.tuning.join("").includes("#")?alert("Invalid tuning"):(function(t){let e=new URL(window.location.href),n=["startFret","endFret","accidentals","tuning","scale"];for(let r of n)""!==t[r]?"tuning"===r?e.searchParams.set(r,t[r].join(",")):e.searchParams.set(r,t[r]):e.searchParams.delete(r);history.replaceState(null,document.title,e)}(F),function(){for(let t of F.tuning)if(!b[F.accidentals].includes(t))return!1}(),void function(t){for(let t in F.tuning)F.strings[t]||(F.strings[t]={selected:[]}),F.strings[t].pitch=F.tuning[t];for(let t=Object.keys(F.strings).length;t>=0;t--)if(t>=F.tuning.length)F.strings.splice(t,1);else for(let e in F.strings[t].selected)(F.strings[t].selected[e].fret>F.endFret||F.strings[t].selected[e].fret<F.startFret)&&F.strings[t].selected.splice(e,1);t&&s(F),function(t){!function(t){f=document.getElementById("fretboard"),u=f.getContext("2d"),g=t.endFret-t.startFret+1,h=t.strings.length-1,f.style.height=8*t.strings.length+"%",f.style.width=g<=20?100*g+"px":"95%";let e=f.getBoundingClientRect();f.height=Math.floor(e.height),f.width=Math.floor(e.width),p={height:f.height-m.top-m.bottom,width:f.width-m.left-m.right},a=p.height/h,d=p.width/g}(t),u.clearRect(0,0,f.width,f.height),u.beginPath(),u.lineWidth=2,u.strokeStyle=c.grid,u.rect(m.left,m.top,p.width,p.height);for(let e=0;e<h+1;e++)u.strokeStyle=c.grid,u.moveTo(m.left,m.top+e*a),u.lineTo(m.left+p.width,m.top+e*a),u.fillStyle=c.leftClick,u.font="17px literata",u.textAlign="center",u.fillText(t.strings[e].pitch.toUpperCase(),10,m.top+e*a+6);for(let e=0;e<g;e++)u.fillStyle=c.grid,u.moveTo(m.left+e*d,m.top),u.lineTo(m.left+e*d,m.top+p.height),u.fillStyle=c.leftClick,u.font="17px literata",u.textAlign="center",u.fillText(e+t.startFret,m.left+e*d+d/2,m.top+p.height+40);u.stroke();for(let e in t.strings)for(let n in t.strings[e].selected){let r=t.strings[e].selected[n];u.beginPath();let l=.7*d/2;l>20&&(l=20),u.strokeStyle=c.noteBorder,u.lineWidth=1,u.arc(m.left+(r.fret-t.startFret)*d+d/2,m.top+e*a,l,0,2*Math.PI),u.fillStyle=r.colour,u.fill(),u.stroke(),u.beginPath(),u.fillStyle=c.noteText,u.font=d/5+"px literata",u.textAlign="center";let i=b[t.accidentals].indexOf(t.strings[e].pitch),o=b[t.accidentals][(i+r.fret)%12];o=o.charAt(0).toUpperCase()+o.slice(1),u.fillText(o,m.left+(r.fret-t.startFret)*d+d/2,m.top+e*a+d/13),u.stroke()}}(F)}(t))}function k(){for(let t of F.strings)t.selected=[];document.getElementById("scale-input").value="",w(!1)}function x(){let t=document.createElement("a");t.download="fretboard.png",t.href=document.getElementById("fretboard").toDataURL(),t.click()}window.onload=function(){!function(){let t=new URLSearchParams(window.location.search);t.get("tuning")&&(document.getElementById("tuning-input").value=t.get("tuning").toUpperCase().split(",").reverse().join(",")),t.get("startFret")&&(document.getElementById("frets-input").value=t.get("startFret")+"-"+t.get("endFret")),document.accidentalsForm.accidentals.value=t.get("accidentals"),t.get("scale")?(document.getElementById("scale-input").value=t.get("scale")||"",w(!0)):w(!1)}(),[...document.getElementsByTagName("input")].forEach((t=>{t.onchange=w})),document.getElementById("fretboard").onclick=function(t){y(t,F,!1)},document.getElementById("fretboard").addEventListener("contextmenu",(function(t){t.preventDefault(),y(t,F,!0)}),!1),window.addEventListener("resize",w),document.getElementById("clear").onclick=k,document.getElementById("download").onclick=x}})();</script>
</html>